{"remainingRequest":"/Users/takanosayaka/Documents/GitHub/makeup_flowchart_vue3/node_modules/babel-loader/lib/index.js!/Users/takanosayaka/Documents/GitHub/makeup_flowchart_vue3/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/takanosayaka/Documents/GitHub/makeup_flowchart_vue3/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/takanosayaka/Documents/GitHub/makeup_flowchart_vue3/src/views/Flowchart.vue?vue&type=script&setup=true&lang=js","dependencies":[{"path":"/Users/takanosayaka/Documents/GitHub/makeup_flowchart_vue3/src/views/Flowchart.vue","mtime":1664453635767},{"path":"/Users/takanosayaka/Documents/GitHub/makeup_flowchart_vue3/babel.config.js","mtime":1661341671887},{"path":"/Users/takanosayaka/Documents/GitHub/makeup_flowchart_vue3/node_modules/cache-loader/dist/cjs.js","mtime":1663381957340},{"path":"/Users/takanosayaka/Documents/GitHub/makeup_flowchart_vue3/node_modules/babel-loader/lib/index.js","mtime":1663381957251},{"path":"/Users/takanosayaka/Documents/GitHub/makeup_flowchart_vue3/node_modules/cache-loader/dist/cjs.js","mtime":1663381957340},{"path":"/Users/takanosayaka/Documents/GitHub/makeup_flowchart_vue3/node_modules/vue-loader-v16/dist/index.js","mtime":1663381993401}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1leGNlcHRpb24uc3RhY2suanMiOwppbXBvcnQgeyBCYWNrZ3JvdW5kLCBDb250cm9scywgTWluaU1hcCwgVnVlRmxvdywgaXNFZGdlLCBNYXJrZXJUeXBlLCBDb25uZWN0aW9uTW9kZSwgdXNlVnVlRmxvdyB9IGZyb20gJ0BicmFrcy92dWUtZmxvdyc7CmltcG9ydCB7IG1hcmtSYXcsIHJlZiB9IGZyb20gJ3Z1ZSc7CmltcG9ydCB7IHVzZVN0b3JlIH0gZnJvbSAndnVleCc7CmltcG9ydCB7IHVzZVJvdXRlciB9IGZyb20gJ3Z1ZS1yb3V0ZXInOwppbXBvcnQgeyB0ZXN0SW5pdGlhbEVsZW1lbnRzIH0gZnJvbSAnLi4vanMvaW5pdGlhbC1lbGVtZW50cy5qcyc7IC8v44Kr44K544K/44Og44OO44O844OJ44Gu6L+95YqgCgppbXBvcnQgTWFrZU5vZGUgZnJvbSAnQC9jb21wb25lbnRzL01ha2VOb2RlLnZ1ZSc7CmltcG9ydCBNb3RpdmF0aW9uTm9kZSBmcm9tICdAL2NvbXBvbmVudHMvTW90aXZhdGlvbk5vZGUudnVlJzsKaW1wb3J0IFNlYXNvbk5vZGUgZnJvbSAnQC9jb21wb25lbnRzL1NlYXNvbk5vZGUudnVlJzsKaW1wb3J0IFRpbWVOb2RlIGZyb20gJ0AvY29tcG9uZW50cy9UaW1lTm9kZS52dWUnOyAvL+WtkOOCs+ODs+ODneODvOODjeODs+ODiOOBrui/veWKoAoKaW1wb3J0IE5vZGVTZXR0aW5ncyBmcm9tICdAL2NvbXBvbmVudHMvTm9kZVNldHRpbmdzLnZ1ZSc7CmltcG9ydCBGYWNlSW1hZ2UgZnJvbSAnQC9jb21wb25lbnRzL0ZhY2VJbWFnZS52dWUnOwppbXBvcnQgTm9kZUZpZWxkIGZyb20gJ0AvY29tcG9uZW50cy9Ob2RlRmllbGQudnVlJzsKaW1wb3J0IFRvcE1lbnUgZnJvbSAnQC9jb21wb25lbnRzL1RvcE1lbnUudnVlJzsgLy/jg6njgqTjg5bjg6njg6rjga7ov73liqAKCmltcG9ydCBWdWVTaW1wbGVDb250ZXh0TWVudSBmcm9tICd2dWUtc2ltcGxlLWNvbnRleHQtbWVudSc7CmltcG9ydCAndnVlLXNpbXBsZS1jb250ZXh0LW1lbnUvZGlzdC92dWUtc2ltcGxlLWNvbnRleHQtbWVudS5jc3MnOwppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiOyAvL+WIneacn+ioreWumgoKLyogdnVlLWZsb3fjga7liJ3mnJ/oqK3lrpogKi8KCmV4cG9ydCBkZWZhdWx0IHsKICBfX25hbWU6ICdGbG93Y2hhcnQnLAoKICBzZXR1cChfX3Byb3BzLCB7CiAgICBleHBvc2UKICB9KSB7CiAgICBleHBvc2UoKTsKICAgIGNvbnN0IHsKICAgICAgb25QYW5lUmVhZHksCiAgICAgIG9uQ29ubmVjdCwKICAgICAgb25FZGdlc0NoYW5nZSwKICAgICAgb25Ob2Rlc0NoYW5nZSwKICAgICAgYWRkRWRnZXMsCiAgICAgIGFkZE5vZGVzLAogICAgICBzZXRUcmFuc2Zvcm0sCiAgICAgIHRvT2JqZWN0LAogICAgICBwcm9qZWN0LAogICAgICBnZXROb2RlLAogICAgICBnZXRFZGdlCiAgICB9ID0gdXNlVnVlRmxvdygpOwogICAgY29uc3QgZWxlbWVudHMgPSByZWYodGVzdEluaXRpYWxFbGVtZW50cyk7CiAgICBjb25zdCBub2RlVHlwZXMgPSB7CiAgICAgIGN1c3RvbU1ha2U6IG1hcmtSYXcoTWFrZU5vZGUpLAogICAgICBjdXN0b21Nb3RpdmF0aW9uOiBtYXJrUmF3KE1vdGl2YXRpb25Ob2RlKSwKICAgICAgY3VzdG9tU2Vhc29uOiBtYXJrUmF3KFNlYXNvbk5vZGUpLAogICAgICBjdXN0b21UaW1lOiBtYXJrUmF3KFRpbWVOb2RlKQogICAgfTsKICAgIC8qIHN0b3Jl44Gocm91dGVy44Gu6ZaL5aeLICovCgogICAgY29uc3Qgc3RvcmUgPSB1c2VTdG9yZSgpOwogICAgY29uc3Qgcm91dGVyID0gdXNlUm91dGVyKCk7CiAgICAvKiDjg47jg7zjg4njga7nrqHnkIblpInmlbAgKi8KCiAgICB2YXIgU2tleXMgPSBbXTsgLy9zb3VyY2UKCiAgICB2YXIgZWRnZVNOdW0gPSBbXTsgLy9zb3VyY2XjgYvjgonopovjgZ9lZGdl44Gu6YeN6KSHIHNvdXJjZTpbaWRdCgogICAgdmFyIG1ha2VOb2RlTnVtID0gewogICAgICAwOiBbXSwKICAgICAgMTogW10sCiAgICAgIDI6IFtdLAogICAgICAzOiBbXSwKICAgICAgNDogW10sCiAgICAgIDU6IFtdLAogICAgICA2OiBbXSwKICAgICAgNzogW10KICAgIH07IC8vaW1nTnVtOltpZF0KCiAgICAvKiB2dWUtc2ltcGxlLWNvbnRleHQtbWVudeOBruWIneacn+ioreWumiAqLwoKICAgIGNvbnN0IG9wdGlvbnMgPSBbewogICAgICBuYW1lOiAiQ29weSIsCiAgICAgIHNsdWc6ICJjb3B5IgogICAgfV07CiAgICBjb25zdCB2dWVDb250ZXh0TWVudSA9IHJlZih0ZXN0SW5pdGlhbEVsZW1lbnRzKTsKICAgIC8qIHZ1ZS1zaW1wbGUtY29udGV4dC1tZW5144Gu6Zai5pWwICovCgogICAgY29uc3QgaGFuZGxlQ2xpY2sgPSBldmVudCA9PiB7CiAgICAgIC8vIG92ZXJ3cml0ZSByZWFkb25seSBwcm9wZXJ0aWVzIHBhZ2VYIGFuZCBwYWdlWSBhbmQgc2V0IGNvcnJlY3QgdmFsdWVzCiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShldmVudCwgJ3BhZ2VYJywgewogICAgICAgIHZhbHVlOiBldmVudC5wYWdlWCAtIDM1MCwKICAgICAgICB3cml0YWJsZTogdHJ1ZQogICAgICB9KTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV2ZW50LCAncGFnZVknLCB7CiAgICAgICAgdmFsdWU6IGV2ZW50LnBhZ2VZIC0gMTAwLAogICAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICAgIH0pOwogICAgICB2dWVDb250ZXh0TWVudS52YWx1ZS5zaG93TWVudShldmVudCk7CiAgICB9OyAvL+OCs+ODs+ODhuOCreOCueODiOODoeODi+ODpeODvOOCkuWRvOOBs+WHuuOBmQoKCiAgICBjb25zdCBzZWxlY3RNZW51ID0gcGFyYW1zID0+IHsKICAgICAgc3RvcmUuY29tbWl0KCJzZXRTZWxlY3ROb2RlTGlzdCIsIHBhcmFtcy5ub2Rlcyk7CiAgICB9OyAvL+OCs+ODs+ODhuOCreOCueODiOODoeODi+ODpeODvOOBruOCr+ODquODg+OCrwoKCiAgICBjb25zdCBvcHRpb25DbGlja2VkID0gKCkgPT4gewogICAgICB2YXIgY29weU5vZGU7CiAgICAgIHZhciBjb3B5Tm9kZXNEYXRhID0gc3RvcmUuc3RhdGUuc2VsZWN0bm9kZUxpc3Q7CgogICAgICBmb3IgKHZhciBzID0gMDsgcyA8IGNvcHlOb2Rlc0RhdGEubGVuZ3RoOyBzKyspIHsKICAgICAgICB2YXIgY29weU5vZGVEYXRhID0gc3RvcmUuc3RhdGUuc2VsZWN0bm9kZUxpc3Rbc107CgogICAgICAgIGlmIChjb3B5Tm9kZURhdGEudHlwZSA9PSAnaW5wdXQnIHx8IGNvcHlOb2RlRGF0YS50eXBlID09ICdvdXRwdXQnKSB7CiAgICAgICAgICAvL+mWi+Wni+ODjuODvOODieOBi+e1guS6huODjuODvOODiQogICAgICAgICAgY29weU5vZGUgPSB7CiAgICAgICAgICAgIGlkOiBzc19nZXRJZCgpLAogICAgICAgICAgICB0eXBlOiBjb3B5Tm9kZURhdGEudHlwZSwKICAgICAgICAgICAgcG9zaXRpb246IHByb2plY3QoewogICAgICAgICAgICAgIHg6IGNvcHlOb2RlRGF0YS5wb3NpdGlvbi54ICsgMTAwLAogICAgICAgICAgICAgIHk6IGNvcHlOb2RlRGF0YS5wb3NpdGlvbi55ICsgMTAwCiAgICAgICAgICAgIH0pLAogICAgICAgICAgICBsYWJlbDogY29weU5vZGVEYXRhLmxhYmVsCiAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSBpZiAoY29weU5vZGVEYXRhLnR5cGUgPT0gJ2N1c3RvbU1ha2UnKSB7CiAgICAgICAgICAvL+ODoeOCpOOCr+ODjuODvOODiQogICAgICAgICAgY29weU5vZGUgPSB7CiAgICAgICAgICAgIGlkOiBtX2dldElkKCksCiAgICAgICAgICAgIHR5cGU6IGNvcHlOb2RlRGF0YS50eXBlLAogICAgICAgICAgICBwb3NpdGlvbjogcHJvamVjdCh7CiAgICAgICAgICAgICAgeDogY29weU5vZGVEYXRhLnBvc2l0aW9uLnggKyAxMDAsCiAgICAgICAgICAgICAgeTogY29weU5vZGVEYXRhLnBvc2l0aW9uLnkgKyAxMDAKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIGxhYmVsOiBjb3B5Tm9kZURhdGEubGFiZWwsCiAgICAgICAgICAgIHN0eWxlOiBjb3B5Tm9kZURhdGEuc3R5bGUsCiAgICAgICAgICAgIGRhdGE6IGNvcHlOb2RlRGF0YS5kYXRhCiAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvL+WIhuWykO+8iOODluODqeODs+ODge+8ieODjuODvOODiQogICAgICAgICAgY29weU5vZGUgPSB7CiAgICAgICAgICAgIGlkOiBjb3B5Tm9kZURhdGEudHlwZSA9PSAnY3VzdG9tTW90aXZhdGlvbicgPyBtdl9nZXRJZCgpIDogY29weU5vZGVEYXRhLnR5cGUgPT0gJ2N1c3RvbVNlYXNvbicgPyBzX2dldElkKCkgOiB0X2dldElkKCksCiAgICAgICAgICAgIHR5cGU6IGNvcHlOb2RlRGF0YS50eXBlLAogICAgICAgICAgICBwb3NpdGlvbjogcHJvamVjdCh7CiAgICAgICAgICAgICAgeDogY29weU5vZGVEYXRhLnBvc2l0aW9uLnggKyAxMDAsCiAgICAgICAgICAgICAgeTogY29weU5vZGVEYXRhLnBvc2l0aW9uLnkgKyAxMDAKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIGxhYmVsOiBjb3B5Tm9kZURhdGEubGFiZWwsCiAgICAgICAgICAgIHN0eWxlOiBjb3B5Tm9kZURhdGEuc3R5bGUKICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICBhZGROb2RlcyhbY29weU5vZGVdKTsKICAgICAgfQogICAgfTsKICAgIC8qIOi1t+WLleaZguOBruaMmeWLlSAqLwogICAgLy9vblBhbmVSZWFkeeOBr+OAgXZpZXdwYW5l44Go44OO44O844OJ44Gr6KGo56S65Y+v6IO944Gq44OH44Kj44Oh44Oz44K344On44Oz44GM44GC44KL5aC05ZCI44Gr5ZG844Gz5Ye644GV44KM44G+44GZCgoKICAgIG9uUGFuZVJlYWR5KCh7CiAgICAgIGZpdFZpZXcKICAgIH0pID0+IHsKICAgICAgZml0VmlldygpOwogICAgfSk7CgogICAgY29uc3Qgb25Mb2FkID0gZmxvd0luc3RhbmNlID0+IGZsb3dJbnN0YW5jZS5maXRWaWV3KCk7CiAgICAvKiDlr77osaHjga7jg47jg7zjg4njgajjgqjjg4Pjgrjjga7oqr/mn7sgKi8KICAgIC8v5a++6LGh44Ko44OD44K444Go5ZCM44GY44OO44O844OJ44GL44KJ5Ye644Gm44GE44KL44Ko44OD44K444Gu5pys5pWw44KS6L+U44GZKHJldHVybikKCgogICAgY29uc3Qgc3VydmV5U2FtZVNvdXJjZSA9IHNvdXJjZSA9PiB7CiAgICAgIGlmIChTa2V5cy5pbmNsdWRlcyhzb3VyY2UpKSB7CiAgICAgICAgdmFyIHRlbXAyID0gZWRnZVNOdW1bc291cmNlXTsKICAgICAgICByZXR1cm4gdGVtcDIubGVuZ3RoOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAwOwogICAgICB9CiAgICB9OyAvL+WvvuixoeOCqOODg+OCuOOBrui/veWKoC/liYrpmaTjgavkvLTjgYZTa2V5c+OBqGVkZ2VTTnVt44Gu5pu05pawCgoKICAgIGNvbnN0IGNoYW5nZUVkZ2VzID0gKGVkZ2UsIHR5cGUpID0+IHsKICAgICAgLy/jg4fjg7zjgr/lj5fjgZHlj5bjgooKICAgICAgdmFyIGVpZCA9IGVkZ2UuaWQ7CiAgICAgIHZhciBzb3VyY2UgPSBlZGdlLnNvdXJjZTsgLy9Ta2V5c+OBruabtOaWsAoKICAgICAgU2tleXMgPSBPYmplY3Qua2V5cyhlZGdlU051bSk7CgogICAgICBpZiAodHlwZSA9PSAiYWRkIikgewogICAgICAgIGNvbnNvbGUubG9nKCJlZGdlU051beOBruabtOaWsCjov73liqApIik7CgogICAgICAgIGlmIChTa2V5cy5pbmNsdWRlcyhzb3VyY2UpKSB7CiAgICAgICAgICBlZGdlU051bVtzb3VyY2VdLnB1c2goZWlkKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZWRnZVNOdW1bc291cmNlXSA9IFtdOwogICAgICAgICAgZWRnZVNOdW1bc291cmNlXS5wdXNoKGVpZCk7CiAgICAgICAgICBTa2V5cyA9IE9iamVjdC5rZXlzKGVkZ2VTTnVtKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAicmVtb3ZlIikgewogICAgICAgIGNvbnNvbGUubG9nKCJlZGdlU051beOBruabtOaWsCjliYrpmaQpIik7CiAgICAgICAgdmFyIHNhbWVFZGdlU051bSA9IGVkZ2VTTnVtW3NvdXJjZV07CgogICAgICAgIGlmIChzYW1lRWRnZVNOdW0ubGVuZ3RoID49IDIpIHsKICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2FtZUVkZ2VTTnVtLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGlmIChzYW1lRWRnZVNOdW1bal0gPT0gZWlkKSB7CiAgICAgICAgICAgICAgZWRnZVNOdW1bc291cmNlXS5zcGxpY2UoaiwgMSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgZGVsZXRlIGVkZ2VTTnVtW3NvdXJjZV07CiAgICAgICAgICBTa2V5cyA9IE9iamVjdC5rZXlzKGVkZ2VTTnVtKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAiY2hhbmdlIikgewogICAgICAgIGNvbnNvbGUubG9nKCJlZGdlU051beOBruabtOaWsCjlpInmm7QpIik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9OyAvL+WvvuixoeODoeOCpOOCr+ODjuODvOODieOBrui/veWKoC/liYrpmaTmmYLjga5tYWtlTm9kZU51beOBruWApOOBqOihqOekuuOCpOODqeOCueODiOOBruabtOaWsAoKCiAgICBjb25zdCBjaGFuZ2VNYWtlTm9kZXMgPSBub2RlRGF0YSA9PiB7CiAgICAgIGlmIChub2RlRGF0YS50eXBlID09ICJhZGQiKSB7CiAgICAgICAgbWFrZU5vZGVOdW1bbm9kZURhdGEuaW1nTnVtXS5wdXNoKG5vZGVEYXRhLmlkKTsKICAgICAgfSBlbHNlIGlmIChub2RlRGF0YS50eXBlID09ICJyZW1vdmUiKSB7CiAgICAgICAgdmFyIGxlbmd0aE51bSA9IG1ha2VOb2RlTnVtW25vZGVEYXRhLmltZ051bV07CgogICAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgbGVuZ3RoTnVtLmxlbmd0aDsgbisrKSB7CiAgICAgICAgICBpZiAobGVuZ3RoTnVtW25dID09IG5vZGVEYXRhLmlkKSB7CiAgICAgICAgICAgIG1ha2VOb2RlTnVtW25vZGVEYXRhLmltZ051bV0uc3BsaWNlKG4sIDEpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy/jg6HjgqTjgq/jg47jg7zjg4njga7ov73liqAv5YmK6Zmk44Gr5Ly044GG6KGo56S644Kk44Op44K544OI44Gu5pu05pawCgoKICAgICAgZm9yICh2YXIgbCA9IDA7IGwgPCBPYmplY3Qua2V5cyhtYWtlTm9kZU51bSkubGVuZ3RoOyBsKyspIHsKICAgICAgICB2YXIgdGVtcExlbmd0aE51bSA9IG1ha2VOb2RlTnVtW2xdOwoKICAgICAgICBpZiAodGVtcExlbmd0aE51bS5sZW5ndGggPj0gMSkgewogICAgICAgICAgc3RvcmUuY29tbWl0KCJzZXRNYWtlTm9kZUxpc3QiLCB7CiAgICAgICAgICAgIGltZ051bTogbCwKICAgICAgICAgICAgaW1nU3RhdGU6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdG9yZS5jb21taXQoInNldE1ha2VOb2RlTGlzdCIsIHsKICAgICAgICAgICAgaW1nTnVtOiBsLAogICAgICAgICAgICBpbWdTdGF0ZTogZmFsc2UKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfTsgLy90dXJuMuOBq+enu+OCi+WJjeOBq+ODoeOCpOOCr+e1guS6huODjuODvOODieOBjOioree9ruOBleOCjOOBpuOBhOOCi+OBi+eiuuiqjeOBmeOCiwoKICAgIC8qCiAgICBjb25zdCBjaGVja091dHB1dCA9ICgpID0+IHsKICAgICAgZWxlbWVudHMudmFsdWUuZm9yRWFjaCgoZWwpID0+IHsKICAgICAgICBpZiAoaXNOb2RlKGVsKSkgewogICAgICAgIH0KICAgICAgfSkKICAgIH0KICAgICovCgogICAgLyog44OO44O844OJ44Gu5aSJ5pu05pmC44Gr55m654Gr44GZ44KL6Zai5pWwICovCgoKICAgIG9uTm9kZXNDaGFuZ2UocGFyYW1zID0+IHsKICAgICAgLy90eXBlOiBkaW1lbnNpb25zKOmFjee9ru+8ny/jgrXjgqTjgrrmg4XloLEpLCBzZWxlY3QsIGFkZCwgcmVtb3ZlCiAgICAgIC8vcGFyYW1zIGFkZDpbdHlwZSwgaXRlbXt9XSByZW1vdmU6W3R5cGUsIGlkXSBzZWxlY3Q6W3R5cGUsIGlkLCBzZWxlY3RlZF0KICAgICAgZm9yICh2YXIgcSA9IDA7IHEgPCBwYXJhbXMubGVuZ3RoOyBxKyspIHsKICAgICAgICBpZiAocGFyYW1zW3FdLnR5cGUgPT0gImFkZCIpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCLjg47jg7zjg4njga7ov73liqAiKTsgLy/jg6HjgqTjgq/jg47jg7zjg4njgaDjgaPjgZ/jgokKCiAgICAgICAgICBpZiAocGFyYW1zW3FdLml0ZW0udHlwZSA9PSAiY3VzdG9tTWFrZSIpIHsKICAgICAgICAgICAgdmFyIG5vZGVpdGVtcyA9IHBhcmFtc1txXS5pdGVtOwogICAgICAgICAgICB2YXIgbm9kZURhdGEgPSBub2RlaXRlbXMuZGF0YTsgLy/ljJbnsqflt6XnqIvjga7liKTlrpoKCiAgICAgICAgICAgIGlmIChub2RlRGF0YS5wYXJ0TnVtID09IDEgJiYgbm9kZURhdGEuaXRlbU51bSA9PSA4KSB7CiAgICAgICAgICAgICAgY2hhbmdlTWFrZU5vZGVzKHsKICAgICAgICAgICAgICAgIGltZ051bTogMCwKICAgICAgICAgICAgICAgIGlkOiBub2RlaXRlbXMuaWQsCiAgICAgICAgICAgICAgICB0eXBlOiAiYWRkIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGVEYXRhLnBhcnROdW0gPT0gMSAmJiBub2RlRGF0YS5pdGVtTnVtID09IDggJiYgbm9kZURhdGEudHlwZU51bSA9PSAyKSB7CiAgICAgICAgICAgICAgY2hhbmdlTWFrZU5vZGVzKHsKICAgICAgICAgICAgICAgIGltZ051bTogMSwKICAgICAgICAgICAgICAgIGlkOiBub2RlaXRlbXMuaWQsCiAgICAgICAgICAgICAgICB0eXBlOiAiYWRkIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGVEYXRhLnBhcnROdW0gPT0gMiAmJiBub2RlRGF0YS5pdGVtTnVtID09IDExKSB7CiAgICAgICAgICAgICAgY2hhbmdlTWFrZU5vZGVzKHsKICAgICAgICAgICAgICAgIGltZ051bTogMiwKICAgICAgICAgICAgICAgIGlkOiBub2RlaXRlbXMuaWQsCiAgICAgICAgICAgICAgICB0eXBlOiAiYWRkIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGVEYXRhLnBhcnROdW0gPT0gMiAmJiAxMyA8PSBub2RlRGF0YS5pdGVtTnVtICYmIG5vZGVEYXRhLml0ZW1OdW0gPD0gMTYpIHsKICAgICAgICAgICAgICBjaGFuZ2VNYWtlTm9kZXMoewogICAgICAgICAgICAgICAgaW1nTnVtOiAzLAogICAgICAgICAgICAgICAgaWQ6IG5vZGVpdGVtcy5pZCwKICAgICAgICAgICAgICAgIHR5cGU6ICJhZGQiCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAobm9kZURhdGEucGFydE51bSA9PSAyICYmIDE3IDw9IG5vZGVEYXRhLml0ZW1OdW0gJiYgbm9kZURhdGEuaXRlbU51bSA8PSAyMCkgewogICAgICAgICAgICAgIGNoYW5nZU1ha2VOb2Rlcyh7CiAgICAgICAgICAgICAgICBpbWdOdW06IDQsCiAgICAgICAgICAgICAgICBpZDogbm9kZWl0ZW1zLmlkLAogICAgICAgICAgICAgICAgdHlwZTogImFkZCIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIGlmIChub2RlRGF0YS5wYXJ0TnVtID09IDQgJiYgbm9kZURhdGEuaXRlbU51bSA9PSAyNCkgewogICAgICAgICAgICAgIGNoYW5nZU1ha2VOb2Rlcyh7CiAgICAgICAgICAgICAgICBpbWdOdW06IDUsCiAgICAgICAgICAgICAgICBpZDogbm9kZWl0ZW1zLmlkLAogICAgICAgICAgICAgICAgdHlwZTogImFkZCIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIGlmIChub2RlRGF0YS5wYXJ0TnVtID09IDQgJiYgbm9kZURhdGEuaXRlbU51bSA9PSAyNSkgewogICAgICAgICAgICAgIGNoYW5nZU1ha2VOb2Rlcyh7CiAgICAgICAgICAgICAgICBpbWdOdW06IDYsCiAgICAgICAgICAgICAgICBpZDogbm9kZWl0ZW1zLmlkLAogICAgICAgICAgICAgICAgdHlwZTogImFkZCIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIGlmIChub2RlRGF0YS5wYXJ0TnVtID09IDAgJiYgbm9kZURhdGEuaXRlbU51bSA9PSAyMikgewogICAgICAgICAgICAgIGNoYW5nZU1ha2VOb2Rlcyh7CiAgICAgICAgICAgICAgICBpbWdOdW06IDcsCiAgICAgICAgICAgICAgICBpZDogbm9kZWl0ZW1zLmlkLAogICAgICAgICAgICAgICAgdHlwZTogImFkZCIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHBhcmFtc1txXS50eXBlID09ICJyZW1vdmUiKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygi44OO44O844OJ44Gu5YmK6ZmkIik7CgogICAgICAgICAgaWYgKHBhcmFtc1txXS5pZC5pbmRleE9mKCdtYWtlJykgPiAtMSkgewogICAgICAgICAgICAvL+ODoeOCpOOCr+ODjuODvOODieOBoOOBo+OBn+OCiQogICAgICAgICAgICBjb25zdCBybm9kZSA9IGdldE5vZGUudmFsdWUocGFyYW1zW3FdLmlkKTsKICAgICAgICAgICAgY29uc3QgcmRhdGEgPSBybm9kZS5kYXRhOwoKICAgICAgICAgICAgaWYgKHJkYXRhLnBhcnROdW0gPT0gMSAmJiByZGF0YS5pdGVtTnVtID09IDgpIHsKICAgICAgICAgICAgICBjaGFuZ2VNYWtlTm9kZXMoewogICAgICAgICAgICAgICAgaW1nTnVtOiAwLAogICAgICAgICAgICAgICAgaWQ6IHBhcmFtc1txXS5pZCwKICAgICAgICAgICAgICAgIHR5cGU6ICJyZW1vdmUiCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocmRhdGEucGFydE51bSA9PSAxICYmIHJkYXRhLml0ZW1OdW0gPT0gOCAmJiByZGF0YS50eXBlTnVtID09IDIpIHsKICAgICAgICAgICAgICBjaGFuZ2VNYWtlTm9kZXMoewogICAgICAgICAgICAgICAgaW1nTnVtOiAxLAogICAgICAgICAgICAgICAgaWQ6IHBhcmFtc1txXS5pZCwKICAgICAgICAgICAgICAgIHR5cGU6ICJyZW1vdmUiCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocmRhdGEucGFydE51bSA9PSAyICYmIHJkYXRhLml0ZW1OdW0gPT0gMTEpIHsKICAgICAgICAgICAgICBjaGFuZ2VNYWtlTm9kZXMoewogICAgICAgICAgICAgICAgaW1nTnVtOiAyLAogICAgICAgICAgICAgICAgaWQ6IHBhcmFtc1txXS5pZCwKICAgICAgICAgICAgICAgIHR5cGU6ICJyZW1vdmUiCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocmRhdGEucGFydE51bSA9PSAyICYmIDEzIDw9IHJkYXRhLml0ZW1OdW0gJiYgcmRhdGEuaXRlbU51bSA8PSAxNikgewogICAgICAgICAgICAgIGNoYW5nZU1ha2VOb2Rlcyh7CiAgICAgICAgICAgICAgICBpbWdOdW06IDMsCiAgICAgICAgICAgICAgICBpZDogcGFyYW1zW3FdLmlkLAogICAgICAgICAgICAgICAgdHlwZTogInJlbW92ZSIKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIGlmIChyZGF0YS5wYXJ0TnVtID09IDIgJiYgMTcgPD0gcmRhdGEuaXRlbU51bSAmJiByZGF0YS5pdGVtTnVtIDw9IDIwKSB7CiAgICAgICAgICAgICAgY2hhbmdlTWFrZU5vZGVzKHsKICAgICAgICAgICAgICAgIGltZ051bTogNCwKICAgICAgICAgICAgICAgIGlkOiBwYXJhbXNbcV0uaWQsCiAgICAgICAgICAgICAgICB0eXBlOiAicmVtb3ZlIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgaWYgKHJkYXRhLnBhcnROdW0gPT0gNCAmJiByZGF0YS5pdGVtTnVtID09IDI0KSB7CiAgICAgICAgICAgICAgY2hhbmdlTWFrZU5vZGVzKHsKICAgICAgICAgICAgICAgIGltZ051bTogNSwKICAgICAgICAgICAgICAgIGlkOiBwYXJhbXNbcV0uaWQsCiAgICAgICAgICAgICAgICB0eXBlOiAicmVtb3ZlIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgaWYgKHJkYXRhLnBhcnROdW0gPT0gNCAmJiByZGF0YS5pdGVtTnVtID09IDI1KSB7CiAgICAgICAgICAgICAgY2hhbmdlTWFrZU5vZGVzKHsKICAgICAgICAgICAgICAgIGltZ051bTogNiwKICAgICAgICAgICAgICAgIGlkOiBwYXJhbXNbcV0uaWQsCiAgICAgICAgICAgICAgICB0eXBlOiAicmVtb3ZlIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgaWYgKHJkYXRhLnBhcnROdW0gPT0gMCAmJiByZGF0YS5pdGVtTnVtID09IDIyKSB7CiAgICAgICAgICAgICAgY2hhbmdlTWFrZU5vZGVzKHsKICAgICAgICAgICAgICAgIGltZ051bTogNywKICAgICAgICAgICAgICAgIGlkOiBwYXJhbXNbcV0uaWQsCiAgICAgICAgICAgICAgICB0eXBlOiAicmVtb3ZlIgogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAocGFyYW1zW3FdLnR5cGUgPT0gInNlbGVjdCIpIHsKICAgICAgICAgIHZhciBzbm9kZTsKCiAgICAgICAgICBpZiAocGFyYW1zW3FdLmlkLmluZGV4T2YoJ21ha2UnKSA+IC0xIHx8IHBhcmFtc1txXS5pZC5pbmRleE9mKCdicmFuY2gnKSA+IC0xKSB7CiAgICAgICAgICAgIC8v44Oh44Kk44Kv44OO44O844OJ44GL44OW44Op44Oz44OB44OO44O844OJ44Gg44Gj44Gf44KJCiAgICAgICAgICAgIHNub2RlID0gZ2V0Tm9kZS52YWx1ZShwYXJhbXNbcV0uaWQpOwoKICAgICAgICAgICAgaWYgKHBhcmFtc1txXS5zZWxlY3RlZCkgewogICAgICAgICAgICAgIHNub2RlLnN0eWxlWyctLXZmLW5vZGUtY29sb3InXSA9ICcjM2NiMzcxJzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzbm9kZS5zdHlsZVsnLS12Zi1ub2RlLWNvbG9yJ10gPSAnYmxhY2snOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHN0b3JlLnN0YXRlLnR1cm4gPT0gMikgewogICAgICAgICAgICBpZiAocGFyYW1zW3FdLmlkLmluZGV4T2YoJ21ha2UnKSA+IC0xKSB7CiAgICAgICAgICAgICAgLy/jg6HjgqTjgq/jg47jg7zjg4njgaDjgaPjgZ/jgokKICAgICAgICAgICAgICBpZiAocGFyYW1zW3FdLnNlbGVjdGVkKSB7CiAgICAgICAgICAgICAgICBpZiAoIXNub2RlLmRhdGFbInNraXAiXSkgewogICAgICAgICAgICAgICAgICAvL3NraXDjgYxmYWxzZeOBoOOBo+OBn+OCiQogICAgICAgICAgICAgICAgICBzbm9kZS5zdHlsZVsnLS12Zi1ub2RlLXRleHQnXSA9ICcjZmY4YzAwJzsKICAgICAgICAgICAgICAgICAgc25vZGUuZGF0YVsic2tpcCJdID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIC8vc2tpcOOBjHRydWXjgaDjgaPjgZ/jgokKICAgICAgICAgICAgICAgICAgc25vZGUuc3R5bGVbJy0tdmYtbm9kZS10ZXh0J10gPSAnYmxhY2snOwogICAgICAgICAgICAgICAgICBzbm9kZS5kYXRhWyJza2lwIl0gPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAoc3RvcmUuc3RhdGUudHVybiA9PSAzKSB7CiAgICAgICAgICAgIGlmIChwYXJhbXNbcV0uaWQuaW5kZXhPZignbWFrZScpID4gLTEpIHsKICAgICAgICAgICAgICAvL+ODoeOCpOOCr+ODjuODvOODieOBoOOBo+OBn+OCiQogICAgICAgICAgICAgIGlmIChwYXJhbXNbcV0uc2VsZWN0ZWQpIHsKICAgICAgICAgICAgICAgIGlmICghc25vZGUuZGF0YVsiZm9yZ2V0Il0pIHsKICAgICAgICAgICAgICAgICAgLy9mb3JnZXTjgYxmYWxzZeOBoOOBo+OBn+OCiQogICAgICAgICAgICAgICAgICBzbm9kZS5zdHlsZVsiLS12Zi1ub2RlLWJnIl0gPSAicGluayI7CiAgICAgICAgICAgICAgICAgIHNub2RlLmRhdGFbImZvcmdldCJdID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIC8vZm9yZ2V044GMdHJ1ZeOBoOOBo+OBn+OCiQogICAgICAgICAgICAgICAgICBzbm9kZS5zdHlsZVsiLS12Zi1ub2RlLWJnIl0gPSAid2hpdGUiOwogICAgICAgICAgICAgICAgICBzbm9kZS5kYXRhWyJmb3JnZXQiXSA9IGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIC8qIOOCqOODg+OCuOOBruWkieabtOaZguOBq+eZuueBq+OBmeOCi+mWouaVsCAqLwoKICAgIG9uRWRnZXNDaGFuZ2UocGFyYW1zID0+IHsKICAgICAgdmFyIE51bU9mU2FtZVNvdXJjZXM7IC8vcGFyYW1zIGFkZDpbdHlwZSwgaXRlbXt9XSAgcmVtb3ZlOlt0eXBlLCBpZF0gIHNlbGVjdDpbdHlwZSwgaWQsIHNlbGVjdGVkXQoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJhbXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAocGFyYW1zW2ldLnR5cGUgPT0gImFkZCIpIHsKICAgICAgICAgIHZhciBlZGdlSXRlbSA9IHBhcmFtc1tpXS5pdGVtOyAvL2VkZ2VTTnVt44Gr5paw44GX44GE44Ko44OD44K444KS6L+95Yqg44GZ44KLCgogICAgICAgICAgU2tleXMgPSBPYmplY3Qua2V5cyhlZGdlU051bSk7IC8v5pyA5paw54mI44Gr5pu05pawCgogICAgICAgICAgaWYgKFNrZXlzLmluY2x1ZGVzKGVkZ2VJdGVtLnNvdXJjZSkpIHsKICAgICAgICAgICAgZWRnZVNOdW1bZWRnZUl0ZW0uc291cmNlXS5wdXNoKGVkZ2VJdGVtLmlkKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVkZ2VTTnVtW2VkZ2VJdGVtLnNvdXJjZV0gPSBbXTsKICAgICAgICAgICAgZWRnZVNOdW1bZWRnZUl0ZW0uc291cmNlXS5wdXNoKGVkZ2VJdGVtLmlkKTsKICAgICAgICAgICAgU2tleXMgPSBPYmplY3Qua2V5cyhlZGdlU051bSk7CiAgICAgICAgICB9IC8v6L+95Yqg44GZ44KL44Ko44OD44K444Go5ZCM44GYc291cmNl44Gu44Ko44OD44K444GM5L2V5pys44GC44KL44GL6Kq/44G544KLCgoKICAgICAgICAgIE51bU9mU2FtZVNvdXJjZXMgPSBzdXJ2ZXlTYW1lU291cmNlKGVkZ2VJdGVtLnNvdXJjZSk7IC8v44Ko44OD44K444GM54++54q244GnMeacrOS7peS4iuOBguOBo+OBn+OCieOCqOODg+OCuOOCknNtb290aHN0ZXDjgavliIfjgormm7/jgYjjgosKCiAgICAgICAgICBpZiAoTnVtT2ZTYW1lU291cmNlcyA+PSAxKSB7CiAgICAgICAgICAgIGVsZW1lbnRzLnZhbHVlLmZvckVhY2goZWwgPT4gewogICAgICAgICAgICAgIGlmIChpc0VkZ2UoZWwpICYmIGVsLnNvdXJjZSA9PSBlZGdlSXRlbS5zb3VyY2UpIHsKICAgICAgICAgICAgICAgIGVsLnR5cGUgPSAic21vb3Roc3RlcCI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHBhcmFtc1tpXS50eXBlID09ICJyZW1vdmUiKSB7CiAgICAgICAgICB2YXIgc291cmNlOwogICAgICAgICAgdmFyIGVkZ2VEYXRhOyAvL+a2iOOBmeOCqOODg+OCuOOBqOWQjOOBmHNvdXJjZeOBruOCqOODg+OCuOOBjOS9leacrOOBguOCi+OBi+iqv+OBueOCiwoKICAgICAgICAgIGVsZW1lbnRzLnZhbHVlLmZvckVhY2goZWwgPT4gewogICAgICAgICAgICBpZiAoZWwuaWQgPT0gcGFyYW1zW2ldLmlkKSB7CiAgICAgICAgICAgICAgZWRnZURhdGEgPSBlbDsKICAgICAgICAgICAgICBzb3VyY2UgPSBlbC5zb3VyY2U7CiAgICAgICAgICAgICAgTnVtT2ZTYW1lU291cmNlcyA9IHN1cnZleVNhbWVTb3VyY2Uoc291cmNlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7IC8v44Ko44OD44K444GM54++54q244GnMuacrOS7peS4i+OBoOOBo+OBn+OCieOCqOODg+OCuOOCknN0cmFpZ2h044Gr5YiH44KK5pu/44GI44KLCgogICAgICAgICAgaWYgKE51bU9mU2FtZVNvdXJjZXMgPT0gMikgewogICAgICAgICAgICBlbGVtZW50cy52YWx1ZS5mb3JFYWNoKGVsID0+IHsKICAgICAgICAgICAgICBpZiAoaXNFZGdlKGVsKSAmJiBlbC5zb3VyY2UgPT0gc291cmNlKSB7CiAgICAgICAgICAgICAgICBlbC50eXBlID0gInN0cmFpZ2h0IjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSAvL2VkZ2VMaXN044Gu54q25oWL5aSJ5pu0CgoKICAgICAgICAgIGNoYW5nZUVkZ2VzKGVkZ2VEYXRhLCAicmVtb3ZlIik7CiAgICAgICAgfSBlbHNlIGlmIChwYXJhbXNbaV0udHlwZSA9PSAic2VsZWN0IikgewogICAgICAgICAgdmFyIHNlZGdlID0gZ2V0RWRnZS52YWx1ZShwYXJhbXNbaV0uaWQpOwoKICAgICAgICAgIGlmIChwYXJhbXNbaV0uc2VsZWN0ZWQpIHsKICAgICAgICAgICAgc2VkZ2UuYW5pbWF0ZWQgPSB0cnVlOyAvL3R1cm4y44Gg44Gj44Gf44KJ44Op44OZ44Or6Kit5a6a55So44GraWTjgpLkv53lrZjjgZnjgosKCiAgICAgICAgICAgIGlmIChzdG9yZS5zdGF0ZS50dXJuID09IDIpIHsKICAgICAgICAgICAgICBzdG9yZS5jb21taXQoInNldEVkZ2VJZCIsIHBhcmFtc1tpXS5pZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNlZGdlLmFuaW1hdGVkID0gZmFsc2U7IC8vdHVybjLjgaDjgaPjgZ/jgonjg6njg5njg6voqK3lrprnlKjjgatpZOOCkuS/neWtmOOBmeOCiwoKICAgICAgICAgICAgaWYgKHN0b3JlLnN0YXRlLnR1cm4gPT0gMikgewogICAgICAgICAgICAgIHN0b3JlLmNvbW1pdCgic2V0RWRnZUlkIiwgIiIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogICAgLyog44Ko44OD44K444Gu6L+95Yqg5pmC44Gr55m654Gr44GZ44KL6Zai5pWwIG9uQ29ubmVjdC0+b25FZGdlc0NoYW5nZSAqLwoKICAgIG9uQ29ubmVjdChwYXJhbXMgPT4gewogICAgICBjb25zb2xlLmxvZygi44Ko44OD44K444Gu6L+95YqgIik7IC8vcGFyYW1zOltzb3VyY2UsIHNvdXJjZUhhbmRsZSwgdGFyZ2V0LCB0YXJnZXRIYW5kbGVdCiAgICAgIC8v5ZCM44GY44K944O844K544Gu44Ko44OD44K444Gu5pys5pWw44KS5Y+W5b6X44GZ44KLCgogICAgICB2YXIgTnVtT2ZFZGdlOwogICAgICBTa2V5cyA9IE9iamVjdC5rZXlzKGVkZ2VTTnVtKTsKCiAgICAgIGlmIChTa2V5cy5pbmNsdWRlcyhwYXJhbXMuc291cmNlKSkgewogICAgICAgIE51bU9mRWRnZSA9IHN1cnZleVNhbWVTb3VyY2UocGFyYW1zLnNvdXJjZSkgKyAxOwogICAgICB9IGVsc2UgewogICAgICAgIE51bU9mRWRnZSA9IDE7CiAgICAgIH0gLy/mlrDjgZfjgYTjgqjjg4Pjgrjjga7ov73liqAKCgogICAgICB2YXIgbmV3RWRnZTsKCiAgICAgIGNvbnN0IGdldEVkZ2VJZCA9ICgpID0+IGBlJHtwYXJhbXMuc291cmNlfV8ke3BhcmFtcy50YXJnZXR9YDsKCiAgICAgIGlmIChOdW1PZkVkZ2UgPCAzKSB7CiAgICAgICAgaWYgKHBhcmFtcy5zb3VyY2UuaW5kZXhPZignbWFrZScpID4gLTEpIHsKICAgICAgICAgIC8vY3VzdG9tTWFrZeOBoOOBo+OBn+OCiQogICAgICAgICAgaWYgKE51bU9mRWRnZSA8IDIpIHsKICAgICAgICAgICAgbmV3RWRnZSA9IHsKICAgICAgICAgICAgICBpZDogZ2V0RWRnZUlkKCksCiAgICAgICAgICAgICAgc291cmNlOiBwYXJhbXMuc291cmNlLAogICAgICAgICAgICAgIHRhcmdldDogcGFyYW1zLnRhcmdldCwKICAgICAgICAgICAgICB0eXBlOiAnc3RyYWlnaHQnLAogICAgICAgICAgICAgIHN0eWxlOiB7CiAgICAgICAgICAgICAgICBzdHJva2U6ICdibGFjaycKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIG1hcmtlckVuZDogTWFya2VyVHlwZS5BcnJvd0Nsb3NlZCwKICAgICAgICAgICAgICBhbmltYXRlZDogZmFsc2UKICAgICAgICAgICAgfTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8v44Oh44Kk44Kv44OO44O844OJ44Gn44Gv44Ko44OD44K444KSMeacrOOBl+OBi+eUn+OChOOBm+OBquOBhAogICAgICAgICAgICBhbGVydCgiMeOBpOOBruWMlueyp+ODjuODvOODieOBi+OCieWHuuOBm+OCi+efouWNsOOBrzHmnKzjgaDjgZHjgafjgZku6L+95Yqg44Gn5YiG5bKQ44GV44Gb44Gf44GE5aC05ZCI44Gv5YiG5bKQ44OO44O844OJ44KS57mL44GS44Gm44GP44Gg44GV44GEIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHBhcmFtcy5zb3VyY2UuaW5kZXhPZignYnJhbmNoJykgPiAtMSkgewogICAgICAgICAgLy9jdXN0b21CcmFuY2jjgaDjgaPjgZ/jgokKICAgICAgICAgIHZhciBhZGRFZGdlTGFiZWw7CiAgICAgICAgICB2YXIgYWRkRWRnZUNvbG9yOwogICAgICAgICAgdmFyIGFkZEVkZ2VUeXBlOwoKICAgICAgICAgIGlmIChwYXJhbXMuc291cmNlLmluZGV4T2YoJ212YnJhbmNoJykgPiAtMSkgewogICAgICAgICAgICAvL+OChOOCi+awl+ODjuODvOODiQogICAgICAgICAgICBhZGRFZGdlTGFiZWwgPSBOdW1PZkVkZ2UgJSAyID09IDAgPyAi44Gq44GXIiA6ICLjgYLjgooiOwogICAgICAgICAgICBhZGRFZGdlQ29sb3IgPSBOdW1PZkVkZ2UgJSAyID09IDAgPyAnYmx1ZScgOiAncmVkJzsKICAgICAgICAgICAgYWRkRWRnZVR5cGUgPSBOdW1PZkVkZ2UgJSAyID09IDAgPyAnbm8nIDogJ21heCc7CiAgICAgICAgICB9IGVsc2UgaWYgKHBhcmFtcy5zb3VyY2UuaW5kZXhPZignc2JyYW5jaCcpID4gLTEpIHsKICAgICAgICAgICAgLy/lraPnr4Djg47jg7zjg4kKICAgICAgICAgICAgYWRkRWRnZUxhYmVsID0gTnVtT2ZFZGdlICUgMiA9PSAwID8gIuWGrCIgOiAi5aSPIjsKICAgICAgICAgICAgYWRkRWRnZUNvbG9yID0gTnVtT2ZFZGdlICUgMiA9PSAwID8gJ2dyYXknIDogJ2JsdWUnOwogICAgICAgICAgICBhZGRFZGdlVHlwZSA9IE51bU9mRWRnZSAlIDIgPT0gMCA/ICd3aW50ZXInIDogJ3N1bW1lcic7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvL+aZgumWk+ODjuODvOODiQogICAgICAgICAgICBhZGRFZGdlTGFiZWwgPSBOdW1PZkVkZ2UgJSAyID09IDAgPyAi55+t44GEIiA6ICLplbfjgYQiOwogICAgICAgICAgICBhZGRFZGdlQ29sb3IgPSBOdW1PZkVkZ2UgJSAyID09IDAgPyAnYmx1ZScgOiAncmVkJzsKICAgICAgICAgICAgYWRkRWRnZVR5cGUgPSBOdW1PZkVkZ2UgJSAyID09IDAgPyAnc2hvcnQnIDogJ2xvbmcnOwogICAgICAgICAgfQoKICAgICAgICAgIG5ld0VkZ2UgPSB7CiAgICAgICAgICAgIGlkOiBnZXRFZGdlSWQoKSwKICAgICAgICAgICAgc291cmNlOiBwYXJhbXMuc291cmNlLAogICAgICAgICAgICB0YXJnZXQ6IHBhcmFtcy50YXJnZXQsCiAgICAgICAgICAgIHR5cGU6IE51bU9mRWRnZSA+IDEgPyAnc21vb3Roc3RlcCcgOiAnc3RyYWlnaHQnLAogICAgICAgICAgICBsYWJlbDogYWRkRWRnZUxhYmVsLAogICAgICAgICAgICBzdHlsZTogewogICAgICAgICAgICAgIHN0cm9rZTogYWRkRWRnZUNvbG9yCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGxhYmVsU3R5bGU6IHsKICAgICAgICAgICAgICBmaWxsOiAnd2hpdGUnCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGxhYmVsQmdTdHlsZTogewogICAgICAgICAgICAgIGZpbGw6IGFkZEVkZ2VDb2xvcgogICAgICAgICAgICB9LAogICAgICAgICAgICBtYXJrZXJFbmQ6IE1hcmtlclR5cGUuQXJyb3dDbG9zZWQsCiAgICAgICAgICAgIGFuaW1hdGVkOiBmYWxzZSwKICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgIHR5cGU6IGFkZEVkZ2VUeXBlCiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vaW5wdXQvb3V0cHV044Gg44Gj44Gf44KJCiAgICAgICAgICBpZiAoTnVtT2ZFZGdlIDwgMikgewogICAgICAgICAgICBuZXdFZGdlID0gewogICAgICAgICAgICAgIGlkOiBnZXRFZGdlSWQoKSwKICAgICAgICAgICAgICBzb3VyY2U6IHBhcmFtcy5zb3VyY2UsCiAgICAgICAgICAgICAgdGFyZ2V0OiBwYXJhbXMudGFyZ2V0LAogICAgICAgICAgICAgIHR5cGU6ICdzdHJhaWdodCcsCiAgICAgICAgICAgICAgc3R5bGU6IHsKICAgICAgICAgICAgICAgIHN0cm9rZTogJ2JsYWNrJwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgbWFya2VyRW5kOiBNYXJrZXJUeXBlLkFycm93Q2xvc2VkLAogICAgICAgICAgICAgIGFuaW1hdGVkOiBmYWxzZQogICAgICAgICAgICB9OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy/jg6HjgqTjgq/jg47jg7zjg4njgafjga/jgqjjg4PjgrjjgpIx5pys44GX44GL55Sf44KE44Gb44Gq44GECiAgICAgICAgICAgIGFsZXJ0KCIx44Gk44Gu44Oh44Kk44Kv6ZaL5aeLL+e1guS6huODjuODvOODieOBi+OCieWHuuOBm+OCi+efouWNsOOBrzHmnKzjgaDjgZHjgafjgZku6L+95Yqg44Gn5YiG5bKQ44GV44Gb44Gf44GE5aC05ZCI44Gv5YiG5bKQ44OO44O844OJ44KS57mL44GS44Gm44GP44Gg44GV44GEIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy/mlrDjgZfjgY/otrPjgZnjgqjjg4PjgrjjgYwz5pys55uu44Gg44Gj44Gf44KJ6L+95Yqg44GV44Gb44Gq44GECiAgICAgICAgYWxlcnQoIjHjgaTjga7jg47jg7zjg4njgYvjgonlh7rjgZvjgovnn6LljbDjga8y5pys44G+44Gn44Gn44GZLui/veWKoOOBp+WIhuWykOOBleOBm+OBn+OBhOWgtOWQiOOBr+WIhuWykOODjuODvOODieOCkue5i+OBkuOBpuOBj+OBoOOBleOBhCIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgYWRkRWRnZXMoW25ld0VkZ2VdKTsKICAgIH0pOwogICAgLyog44Oe44Km44K55pON5L2c44Gr57WQ44Gz44Gk44GR44Gf6Zai5pWwICovCiAgICAvL+ODjuODvOODieOBruODieODqeODg+OCsOaTjeS9nAoKICAgIGNvbnN0IG9uRHJhZ092ZXIgPSBldmVudCA9PiB7CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgICBpZiAoZXZlbnQuZGF0YVRyYW5zZmVyKSB7CiAgICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSAnbW92ZSc7CiAgICAgIH0KICAgIH07IC8v44OO44O844OJ44Gu44OJ44Ot44OD44OX44Gr44KI44KL77yM5paw6KaP44OO44O844OJ44Gu6L+95YqgCgoKICAgIGxldCBpZCA9IDA7CgogICAgY29uc3Qgc3NfZ2V0SWQgPSAoKSA9PiBgc3NfJHtpZCsrfWA7CgogICAgY29uc3QgbV9nZXRJZCA9ICgpID0+IGBtYWtlXyR7aWQrK31gOwoKICAgIGNvbnN0IG12X2dldElkID0gKCkgPT4gYG12YnJhbmNoXyR7aWQrK31gOwoKICAgIGNvbnN0IHNfZ2V0SWQgPSAoKSA9PiBgc2JyYW5jaF8ke2lkKyt9YDsKCiAgICBjb25zdCB0X2dldElkID0gKCkgPT4gYHRicmFuY2hfJHtpZCsrfWA7CgogICAgY29uc3Qgb25Ecm9wID0gZXZlbnQgPT4gewogICAgICB2YXIgX2V2ZW50JGRhdGFUcmFuc2ZlcjsKCiAgICAgIGNvbnN0IHR5cGUgPSAoX2V2ZW50JGRhdGFUcmFuc2ZlciA9IGV2ZW50LmRhdGFUcmFuc2ZlcikgPT09IG51bGwgfHwgX2V2ZW50JGRhdGFUcmFuc2ZlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2V2ZW50JGRhdGFUcmFuc2Zlci5nZXREYXRhKCdhcHBsaWNhdGlvbi92dWVmbG93Jyk7CiAgICAgIGNvbnN0IHBvc2l0aW9uID0gcHJvamVjdCh7CiAgICAgICAgeDogZXZlbnQuY2xpZW50WCAtIDQwMCwKICAgICAgICB5OiBldmVudC5jbGllbnRZIC0gMTUwCiAgICAgIH0pOwogICAgICB2YXIgbmV3Tm9kZTsKCiAgICAgIGlmICh0eXBlID09ICdpbnB1dCcgfHwgdHlwZSA9PSAnb3V0cHV0JykgewogICAgICAgIC8v6ZaL5aeL44OO44O844OJ44GL57WC5LqG44OO44O844OJCiAgICAgICAgbmV3Tm9kZSA9IHsKICAgICAgICAgIGlkOiBzc19nZXRJZCgpLAogICAgICAgICAgdHlwZSwKICAgICAgICAgIHBvc2l0aW9uLAogICAgICAgICAgbGFiZWw6IHR5cGUgPT0gJ2lucHV0JyA/IGDjg6HjgqTjgq/plovlp4tgIDogYOODoeOCpOOCr+e1guS6hmAKICAgICAgICB9OwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gJ2N1c3RvbU1ha2UnKSB7CiAgICAgICAgLy/jg6HjgqTjgq/jg47jg7zjg4kKICAgICAgICBuZXdOb2RlID0gewogICAgICAgICAgaWQ6IG1fZ2V0SWQoKSwKICAgICAgICAgIHR5cGUsCiAgICAgICAgICBwb3NpdGlvbiwKICAgICAgICAgIGxhYmVsOiBzdG9yZS5zdGF0ZS5pdGVtTmFtZS5sZW5ndGggPj0gNyA/IHN0b3JlLnN0YXRlLml0ZW1OYW1lICsgIlxuKCIgKyBzdG9yZS5zdGF0ZS50eXBlTmFtZSArICIpIiA6IHN0b3JlLnN0YXRlLml0ZW1OYW1lICsgIigiICsgc3RvcmUuc3RhdGUudHlwZU5hbWUgKyAiKSIsCiAgICAgICAgICBzdHlsZTogewogICAgICAgICAgICAnLS12Zi1ub2RlLWNvbG9yJzogJ2JsYWNrJwogICAgICAgICAgfSwKICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgcGFydE5hbWU6IHN0b3JlLnN0YXRlLnBhcnROYW1lLAogICAgICAgICAgICBwYXJ0TnVtOiBzdG9yZS5zdGF0ZS5wYXJ0TnVtLAogICAgICAgICAgICBpdGVtTmFtZTogc3RvcmUuc3RhdGUuaXRlbU5hbWUsCiAgICAgICAgICAgIGl0ZW1OdW06IHN0b3JlLnN0YXRlLml0ZW1OdW0sCiAgICAgICAgICAgIHR5cGVOYW1lOiBzdG9yZS5zdGF0ZS50eXBlTmFtZSwKICAgICAgICAgICAgdHlwZU51bTogc3RvcmUuc3RhdGUudHlwZU51bSwKICAgICAgICAgICAgc2tpcDogZmFsc2UsCiAgICAgICAgICAgIGZvcmdldDogZmFsc2UKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9IGVsc2UgewogICAgICAgIC8v5YiG5bKQ44OO44O844OJCiAgICAgICAgdmFyIG5vZGVMYWJlbDsKICAgICAgICB2YXIgbm9kZUlkOwoKICAgICAgICBpZiAodHlwZSA9PSAnY3VzdG9tTW90aXZhdGlvbicpIHsKICAgICAgICAgIG5vZGVMYWJlbCA9ICLmsJflkIjjgYQiOwogICAgICAgICAgbm9kZUlkID0gbXZfZ2V0SWQoKTsKICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gJ2N1c3RvbVNlYXNvbicpIHsKICAgICAgICAgIG5vZGVMYWJlbCA9ICLlraPnr4AiOwogICAgICAgICAgbm9kZUlkID0gc19nZXRJZCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBub2RlTGFiZWwgPSAi5aSW5Ye65pmC6ZaTIjsKICAgICAgICAgIG5vZGVJZCA9IHRfZ2V0SWQoKTsKICAgICAgICB9CgogICAgICAgIG5ld05vZGUgPSB7CiAgICAgICAgICBpZDogbm9kZUlkLAogICAgICAgICAgdHlwZSwKICAgICAgICAgIHBvc2l0aW9uLAogICAgICAgICAgbGFiZWw6IG5vZGVMYWJlbCwKICAgICAgICAgIHN0eWxlOiB7CiAgICAgICAgICAgICctLXZmLW5vZGUtY29sb3InOiAnYmxhY2snCiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgYWRkTm9kZXMoW25ld05vZGVdKTsKICAgIH07CiAgICAvKiB2dWVGbG935LiK44Gu44Oc44K/44Oz5pON5L2cICovCiAgICAvL+ePvuWcqOOBrnZpZXdwYW5l44Gu5aSJ5o+bICjjgrrjg7zjg6Djgajjg5Hjg7MpIOOCkuODquOCu+ODg+ODiAoKCiAgICBjb25zdCByZXNldFRyYW5zID0gKCkgPT4gewogICAgICBzZXRUcmFuc2Zvcm0oewogICAgICAgIHg6IDAsCiAgICAgICAgeTogMCwKICAgICAgICB6b29tOiAxCiAgICAgIH0pOwogICAgfTsgLy90b09iamVjdOOBr+OAgeePvuWcqOOBruOCsOODqeODleODh+ODvOOCv+OCkuewoeWNmOOBq+awuOe2muWMluOBp+OBjeOCi+OCquODluOCuOOCp+OCr+ODiOOBq+WkieaPmwoKCiAgICBjb25zdCBsb2dUb09iamVjdCA9ICgpID0+IHsKICAgICAgY29uc29sZS5sb2coIuODh+ODvOOCv+OBrm15c3Fs44G444Gu6YCB5L+hIik7CiAgICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTsKICAgICAgcGFyYW1zLmFwcGVuZCgndXNlcklkJywgc3RvcmUuc3RhdGUudXNlcklkKTsKICAgICAgcGFyYW1zLmFwcGVuZCgndXNlck5hbWUnLCBzdG9yZS5zdGF0ZS51c2VyTmFtZSk7CiAgICAgIHBhcmFtcy5hcHBlbmQoJ2Zsb3djaGFydCcsIEpTT04uc3RyaW5naWZ5KHRvT2JqZWN0KCkpKTsKICAgICAgYXhpb3MucG9zdCgnaHR0cHM6Ly90YWthbm8ubmttci5pby9mbG93Y2hhcnRfcG9zdC5waHAnLCBwYXJhbXMpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIC8v5LiK5omL44GP6KGM44Gj44Gf5pmCCiAgICAgICAgY29uc29sZS5sb2coJ3N0YXR1czonLCByZXNwb25zZS5zdGF0dXMpOwogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgLy/lpLHmlZfjgZfjgZ/mmYIKICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycm9yKTsKICAgICAgfSk7IC8v44OV44Ot44O844OB44Oj44O844OI44OH44O844K/44Gu44OA44Km44Oz44Ot44O844OJCgogICAgICAvKgogICAgICBjb25zdCBmaWxlTmFtZSA9IHN0b3JlLnN0YXRlLnVzZXJOYW1lKyIuanNvbiIKICAgICAgY29uc3QgZmxvd0RhdGEgPSBKU09OLnN0cmluZ2lmeSh0b09iamVjdCgpKQogICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpCiAgICAgIGxpbmsuaHJlZiA9ICJkYXRhOnRleHQvcGxhaW4sIiArIGVuY29kZVVSSUNvbXBvbmVudChmbG93RGF0YSkKICAgICAgbGluay5kb3dubG9hZCA9IGZpbGVOYW1lCiAgICAgIGxpbmsuY2xpY2soKQogICAgICAqLwogICAgICAvL+ODleODreODvOODgeODo+ODvOODiOeUu+WDj+OBruODgOOCpuODs+ODreODvOODiQoKICAgICAgdmFyIHN2ZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5iYXNpY2Zsb3cnKTsKICAgICAgdmFyIHN2Z0RhdGEgPSBuZXcgWE1MU2VyaWFsaXplcigpLnNlcmlhbGl6ZVRvU3RyaW5nKHN2Zyk7CiAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKTsKICAgICAgY2FudmFzLndpZHRoID0gIjgwMHB4IjsgLy9zdmcud2lkdGguYmFzZVZhbC52YWx1ZQoKICAgICAgY2FudmFzLmhlaWdodCA9ICI3NjBweCI7IC8vc3ZnLmhlaWdodC5iYXNlVmFsLnZhbHVlCgogICAgICB2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoIjJkIik7CiAgICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZSgpOwoKICAgICAgaW1hZ2Uub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1hZ2UsIDAsIDApOwogICAgICAgIHZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgICAgIGEuaHJlZiA9IGNhbnZhcy50b0RhdGFVUkwoImltYWdlL3BuZyIpOwogICAgICAgIGEuc2V0QXR0cmlidXRlKCJkb3dubG9hZCIsIHN0b3JlLnN0YXRlLnVzZXJOYW1lICsgIi5wbmciKTsKICAgICAgICBhLmRpc3BhdGNoRXZlbnQobmV3IE1vdXNlRXZlbnQoImNsaWNrIikpOwogICAgICB9OwoKICAgICAgaW1hZ2Uuc3JjID0gImRhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PXV0Zi04O2Jhc2U2NCwiICsgYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoc3ZnRGF0YSkpKTsKICAgIH07CgogICAgY29uc3Qgc3VibWl0Rmxvd2NoYXJ0ID0gKCkgPT4gewogICAgICBjb25zb2xlLmxvZygi44OH44O844K/44GubXlzcWzjgbjjga7pgIHkv6Em5a6f6aiT57WC5LqGIik7CiAgICAgIGNvbnN0IHBhcmFtczIgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7CiAgICAgIHBhcmFtczIuYXBwZW5kKCd1c2VySWQnLCBzdG9yZS5zdGF0ZS51c2VySWQpOwogICAgICBwYXJhbXMyLmFwcGVuZCgndXNlck5hbWUnLCBzdG9yZS5zdGF0ZS51c2VyTmFtZSk7CiAgICAgIHBhcmFtczIuYXBwZW5kKCdmbG93Y2hhcnQnLCBKU09OLnN0cmluZ2lmeSh0b09iamVjdCgpKSk7CiAgICAgIGF4aW9zLnBvc3QoJ2h0dHBzOi8vdGFrYW5vLm5rbXIuaW8vZmxvd2NoYXJ0X3Bvc3QucGhwJywgcGFyYW1zMikudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgLy/kuIrmiYvjgY/ooYzjgaPjgZ/mmYIKICAgICAgICBjb25zb2xlLmxvZygnc3RhdHVzOicsIHJlc3BvbnNlLnN0YXR1cyk7CiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAvL+WkseaVl+OBl+OBn+aZggogICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgZXJyb3IpOwogICAgICB9KTsgLy/jg5Xjg63jg7zjg4Hjg6Pjg7zjg4jjg4fjg7zjgr/jga7jg4Djgqbjg7Pjg63jg7zjg4kKCiAgICAgIGNvbnN0IGZpbGVOYW1lMiA9IHN0b3JlLnN0YXRlLnVzZXJOYW1lICsgIi5qc29uIjsKICAgICAgY29uc3QgZmxvd0RhdGEyID0gSlNPTi5zdHJpbmdpZnkodG9PYmplY3QoKSk7CiAgICAgIGNvbnN0IGxpbmsyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgICBsaW5rMi5ocmVmID0gImRhdGE6dGV4dC9wbGFpbiwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGZsb3dEYXRhMik7CiAgICAgIGxpbmsyLmRvd25sb2FkID0gZmlsZU5hbWUyOwogICAgICBsaW5rMi5jbGljaygpOyAvL+Wun+mok+e1guS6hueUu+mdouOBuOenu+WLlQoKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgcm91dGVyLnB1c2goJy9maW5pc2gnKTsKICAgICAgfSwgMzAwMCk7CiAgICB9OwoKICAgIGNvbnN0IF9fcmV0dXJuZWRfXyA9IHsKICAgICAgb25QYW5lUmVhZHksCiAgICAgIG9uQ29ubmVjdCwKICAgICAgb25FZGdlc0NoYW5nZSwKICAgICAgb25Ob2Rlc0NoYW5nZSwKICAgICAgYWRkRWRnZXMsCiAgICAgIGFkZE5vZGVzLAogICAgICBzZXRUcmFuc2Zvcm0sCiAgICAgIHRvT2JqZWN0LAogICAgICBwcm9qZWN0LAogICAgICBnZXROb2RlLAogICAgICBnZXRFZGdlLAogICAgICBlbGVtZW50cywKICAgICAgbm9kZVR5cGVzLAogICAgICBzdG9yZSwKICAgICAgcm91dGVyLAogICAgICBTa2V5cywKICAgICAgZWRnZVNOdW0sCiAgICAgIG1ha2VOb2RlTnVtLAogICAgICBvcHRpb25zLAogICAgICB2dWVDb250ZXh0TWVudSwKICAgICAgaGFuZGxlQ2xpY2ssCiAgICAgIHNlbGVjdE1lbnUsCiAgICAgIG9wdGlvbkNsaWNrZWQsCiAgICAgIG9uTG9hZCwKICAgICAgc3VydmV5U2FtZVNvdXJjZSwKICAgICAgY2hhbmdlRWRnZXMsCiAgICAgIGNoYW5nZU1ha2VOb2RlcywKICAgICAgb25EcmFnT3ZlciwKICAgICAgaWQsCiAgICAgIHNzX2dldElkLAogICAgICBtX2dldElkLAogICAgICBtdl9nZXRJZCwKICAgICAgc19nZXRJZCwKICAgICAgdF9nZXRJZCwKICAgICAgb25Ecm9wLAogICAgICByZXNldFRyYW5zLAogICAgICBsb2dUb09iamVjdCwKICAgICAgc3VibWl0Rmxvd2NoYXJ0LAogICAgICBCYWNrZ3JvdW5kLAogICAgICBDb250cm9scywKICAgICAgTWluaU1hcCwKICAgICAgVnVlRmxvdywKICAgICAgaXNFZGdlLAogICAgICBNYXJrZXJUeXBlLAogICAgICBDb25uZWN0aW9uTW9kZSwKICAgICAgdXNlVnVlRmxvdywKICAgICAgbWFya1JhdywKICAgICAgcmVmLAogICAgICB1c2VTdG9yZSwKICAgICAgdXNlUm91dGVyLAogICAgICB0ZXN0SW5pdGlhbEVsZW1lbnRzLAogICAgICBNYWtlTm9kZSwKICAgICAgTW90aXZhdGlvbk5vZGUsCiAgICAgIFNlYXNvbk5vZGUsCiAgICAgIFRpbWVOb2RlLAogICAgICBOb2RlU2V0dGluZ3MsCiAgICAgIEZhY2VJbWFnZSwKICAgICAgTm9kZUZpZWxkLAogICAgICBUb3BNZW51LAogICAgICBWdWVTaW1wbGVDb250ZXh0TWVudSwKICAgICAgYXhpb3MKICAgIH07CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoX19yZXR1cm5lZF9fLCAnX19pc1NjcmlwdFNldHVwJywgewogICAgICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgICAgdmFsdWU6IHRydWUKICAgIH0pOwogICAgcmV0dXJuIF9fcmV0dXJuZWRfXzsKICB9Cgp9Ow=="},{"version":3,"mappings":"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","names":["Background","Controls","MiniMap","VueFlow","isEdge","MarkerType","ConnectionMode","useVueFlow","markRaw","ref","useStore","useRouter","testInitialElements","MakeNode","MotivationNode","SeasonNode","TimeNode","NodeSettings","FaceImage","NodeField","TopMenu","VueSimpleContextMenu","axios","onPaneReady","onConnect","onEdgesChange","onNodesChange","addEdges","addNodes","setTransform","toObject","project","getNode","getEdge","elements","nodeTypes","customMake","customMotivation","customSeason","customTime","store","router","Skeys","edgeSNum","makeNodeNum","options","name","slug","vueContextMenu","handleClick","event","Object","defineProperty","value","pageX","writable","pageY","showMenu","selectMenu","params","commit","nodes","optionClicked","copyNode","copyNodesData","state","selectnodeList","s","length","copyNodeData","type","id","ss_getId","position","x","y","label","m_getId","style","data","mv_getId","s_getId","t_getId","fitView","onLoad","flowInstance","surveySameSource","source","includes","temp2","changeEdges","edge","eid","keys","console","log","push","sameEdgeSNum","j","splice","changeMakeNodes","nodeData","imgNum","lengthNum","n","l","tempLengthNum","imgState","q","item","nodeitems","partNum","itemNum","typeNum","indexOf","rnode","rdata","snode","selected","turn","NumOfSameSources","i","edgeItem","forEach","el","edgeData","sedge","animated","NumOfEdge","newEdge","getEdgeId","target","stroke","markerEnd","ArrowClosed","alert","addEdgeLabel","addEdgeColor","addEdgeType","labelStyle","fill","labelBgStyle","onDragOver","preventDefault","dataTransfer","dropEffect","onDrop","getData","clientX","clientY","newNode","itemName","typeName","partName","skip","forget","nodeLabel","nodeId","resetTrans","zoom","logToObject","URLSearchParams","append","userId","userName","JSON","stringify","post","then","response","status","catch","error","svg","document","querySelector","svgData","XMLSerializer","serializeToString","canvas","createElement","width","height","ctx","getContext","image","Image","onload","drawImage","a","href","toDataURL","setAttribute","dispatchEvent","MouseEvent","src","btoa","unescape","encodeURIComponent","submitFlowchart","params2","fileName2","flowData2","link2","download","click","setTimeout"],"sources":["/Users/takanosayaka/Documents/GitHub/makeup_flowchart_vue3/src/views/Flowchart.vue"],"sourcesContent":["<script setup>\nimport { Background, Controls, MiniMap, VueFlow, isEdge, MarkerType, ConnectionMode, useVueFlow, } from '@braks/vue-flow'\nimport { markRaw, ref, } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\nimport { testInitialElements } from '../js/initial-elements.js'\n//カスタムノードの追加\nimport MakeNode from '@/components/MakeNode.vue'\nimport MotivationNode from '@/components/MotivationNode.vue'\nimport SeasonNode from '@/components/SeasonNode.vue'\nimport TimeNode from '@/components/TimeNode.vue'\n//子コンポーネントの追加\nimport NodeSettings from '@/components/NodeSettings.vue'\nimport FaceImage from '@/components/FaceImage.vue'\nimport NodeField from '@/components/NodeField.vue'\nimport TopMenu from '@/components/TopMenu.vue'\n//ライブラリの追加\nimport VueSimpleContextMenu from 'vue-simple-context-menu';\nimport 'vue-simple-context-menu/dist/vue-simple-context-menu.css';\nimport axios from \"axios\"\n\n//初期設定\n/* vue-flowの初期設定 */\nconst { onPaneReady, onConnect, onEdgesChange, onNodesChange, addEdges, addNodes, setTransform, toObject, project, getNode, getEdge, } = useVueFlow()\nconst elements = ref(testInitialElements)\nconst nodeTypes = {\n  customMake: markRaw(MakeNode),\n  customMotivation: markRaw(MotivationNode),\n  customSeason: markRaw(SeasonNode),\n  customTime: markRaw(TimeNode),\n}\n/* storeとrouterの開始 */\nconst store = useStore()\nconst router = useRouter()\n/* ノードの管理変数 */\nvar Skeys = [] //source\nvar edgeSNum = [] //sourceから見たedgeの重複 source:[id]\nvar makeNodeNum = {0: [], 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: []} //imgNum:[id]\n/* vue-simple-context-menuの初期設定 */\nconst options = [{name: \"Copy\", slug: \"copy\"}]\nconst vueContextMenu = ref(testInitialElements)\n\n\n/* vue-simple-context-menuの関数 */\nconst handleClick =  (event) => {\n  // overwrite readonly properties pageX and pageY and set correct values\n  Object.defineProperty(event, 'pageX', {\n    value: event.pageX - 350,\n    writable: true\n  })\n  Object.defineProperty(event, 'pageY', {\n    value: event.pageY - 100,\n    writable: true\n  })\n  vueContextMenu.value.showMenu(event)\n}\n//コンテキストメニューを呼び出す\nconst selectMenu = (params) => {\n  store.commit(\"setSelectNodeList\", params.nodes)\n}\n//コンテキストメニューのクリック\nconst optionClicked = () => {\n  var copyNode\n  var copyNodesData = store.state.selectnodeList\n  for(var s=0; s<copyNodesData.length; s++){\n    var copyNodeData = store.state.selectnodeList[s]\n    if(copyNodeData.type == 'input' || copyNodeData.type == 'output'){\n      //開始ノードか終了ノード\n      copyNode = {\n        id: ss_getId(),\n        type: copyNodeData.type,\n        position: project({ x: copyNodeData.position.x + 100, y: copyNodeData.position.y + 100 }),\n        label: copyNodeData.label,\n      }\n    }else if(copyNodeData.type == 'customMake'){\n      //メイクノード\n      copyNode = {\n        id: m_getId(),\n        type: copyNodeData.type,\n        position: project({ x: copyNodeData.position.x + 100, y: copyNodeData.position.y + 100 }),\n        label: copyNodeData.label,\n        style: copyNodeData.style,\n        data: copyNodeData.data,\n      }\n    }else{\n      //分岐（ブランチ）ノード\n      copyNode = {\n        id: copyNodeData.type == 'customMotivation'\n          ? mv_getId()\n          : copyNodeData.type == 'customSeason'\n            ? s_getId()\n            : t_getId(),\n        type: copyNodeData.type,\n        position: project({ x: copyNodeData.position.x + 100, y: copyNodeData.position.y + 100 }),\n        label: copyNodeData.label,\n        style: copyNodeData.style,\n      }\n    }\n    addNodes([copyNode])\n  }\n}\n\n/* 起動時の挙動 */\n//onPaneReadyは、viewpaneとノードに表示可能なディメンションがある場合に呼び出されます\nonPaneReady(({fitView}) => {\n  fitView()\n})\nconst onLoad = (flowInstance) => flowInstance.fitView()\n\n/* 対象のノードとエッジの調査 */\n//対象エッジと同じノードから出ているエッジの本数を返す(return)\nconst surveySameSource = (source) => {\n  if(Skeys.includes(source)){\n    var temp2 = edgeSNum[source]\n    return temp2.length\n  }else{\n    return 0\n  }\n}\n//対象エッジの追加/削除に伴うSkeysとedgeSNumの更新\nconst changeEdges = (edge, type) => {\n  //データ受け取り\n  var eid = edge.id\n  var source = edge.source\n  //Skeysの更新\n  Skeys = Object.keys(edgeSNum)\n  if(type == \"add\"){\n    console.log(\"edgeSNumの更新(追加)\")\n    if(Skeys.includes(source)){\n      edgeSNum[source].push(eid)\n    }else{\n      edgeSNum[source] = []\n      edgeSNum[source].push(eid)\n      Skeys = Object.keys(edgeSNum)\n    }\n  }else if(type == \"remove\"){\n    console.log(\"edgeSNumの更新(削除)\")\n    var sameEdgeSNum = edgeSNum[source]\n    if(sameEdgeSNum.length >= 2){\n      for(var j=0; j<sameEdgeSNum.length; j++){\n        if(sameEdgeSNum[j] == eid){\n          edgeSNum[source].splice(j, 1)\n        }\n      }\n    }else{\n      delete edgeSNum[source]\n      Skeys = Object.keys(edgeSNum)\n    }\n  }else if(type == \"change\"){\n    console.log(\"edgeSNumの更新(変更)\")\n  }else{\n    return\n  }\n}\n//対象メイクノードの追加/削除時のmakeNodeNumの値と表示イラストの更新\nconst changeMakeNodes = (nodeData) => {\n  if(nodeData.type == \"add\"){\n    makeNodeNum[nodeData.imgNum].push(nodeData.id)\n  }else if(nodeData.type == \"remove\"){\n    var lengthNum = makeNodeNum[nodeData.imgNum]\n    for(var n=0; n<lengthNum.length; n++){\n      if(lengthNum[n] == nodeData.id){\n        makeNodeNum[nodeData.imgNum].splice(n, 1)\n      }\n    }\n  }else{\n    return\n  }\n\n  //メイクノードの追加/削除に伴う表示イラストの更新\n  for(var l=0; l<Object.keys(makeNodeNum).length; l++){\n    var tempLengthNum = makeNodeNum[l]\n    if(tempLengthNum.length >= 1){\n      store.commit(\"setMakeNodeList\", {imgNum:l, imgState: true})\n    }else{\n      store.commit(\"setMakeNodeList\", {imgNum:l, imgState: false})\n    }\n  }\n}\n//turn2に移る前にメイク終了ノードが設置されているか確認する\n/*\nconst checkOutput = () => {\n  elements.value.forEach((el) => {\n    if (isNode(el)) {\n    }\n  })\n}\n*/\n\n/* ノードの変更時に発火する関数 */\nonNodesChange((params) => {\n  //type: dimensions(配置？/サイズ情報), select, add, remove\n  //params add:[type, item{}] remove:[type, id] select:[type, id, selected]\n  for(var q=0; q<params.length; q++){\n    if(params[q].type == \"add\"){\n      console.log(\"ノードの追加\")\n      //メイクノードだったら\n      if(params[q].item.type == \"customMake\"){\n        var nodeitems = params[q].item\n        var nodeData = nodeitems.data\n        //化粧工程の判定\n        if(nodeData.partNum == 1 && nodeData.itemNum == 8){\n          changeMakeNodes({imgNum: 0, id: nodeitems.id, type: \"add\"})\n        }else if(nodeData.partNum == 1 && nodeData.itemNum == 8 && nodeData.typeNum == 2){\n          changeMakeNodes({imgNum: 1, id: nodeitems.id, type: \"add\"})\n        }else if(nodeData.partNum == 2 && nodeData.itemNum == 11){\n          changeMakeNodes({imgNum: 2, id: nodeitems.id, type: \"add\"})\n        }else if(nodeData.partNum == 2 && (13 <= nodeData.itemNum && nodeData.itemNum <= 16)){\n          changeMakeNodes({imgNum: 3, id: nodeitems.id, type: \"add\"})\n        }else if(nodeData.partNum == 2 && (17 <= nodeData.itemNum && nodeData.itemNum <= 20)){\n          changeMakeNodes({imgNum: 4, id: nodeitems.id, type: \"add\"})\n        }else if(nodeData.partNum == 4 && nodeData.itemNum == 24){\n          changeMakeNodes({imgNum: 5, id: nodeitems.id, type: \"add\"})\n        }else if(nodeData.partNum == 4 && nodeData.itemNum == 25){\n          changeMakeNodes({imgNum: 6, id: nodeitems.id, type: \"add\"})\n        }else if(nodeData.partNum == 0 && nodeData.itemNum == 22){\n          changeMakeNodes({imgNum: 7, id: nodeitems.id, type: \"add\"})\n        }else{\n          return\n        }\n      }\n    }else if(params[q].type == \"remove\"){\n      console.log(\"ノードの削除\")\n      if(params[q].id.indexOf('make') > -1){ //メイクノードだったら\n        const rnode = getNode.value(params[q].id)\n        const rdata = rnode.data\n        if(rdata.partNum == 1 && rdata.itemNum == 8){\n          changeMakeNodes({imgNum: 0, id: params[q].id, type: \"remove\"})\n        }else if(rdata.partNum == 1 && rdata.itemNum == 8 && rdata.typeNum == 2){\n          changeMakeNodes({imgNum: 1, id: params[q].id, type: \"remove\"})\n        }else if(rdata.partNum == 2 && rdata.itemNum == 11){\n          changeMakeNodes({imgNum: 2, id: params[q].id, type: \"remove\"})\n        }else if(rdata.partNum == 2 && (13 <= rdata.itemNum && rdata.itemNum <= 16)){\n          changeMakeNodes({imgNum: 3, id: params[q].id, type: \"remove\"})\n        }else if(rdata.partNum == 2 && (17 <= rdata.itemNum && rdata.itemNum <= 20)){\n          changeMakeNodes({imgNum: 4, id: params[q].id, type: \"remove\"})\n        }else if(rdata.partNum == 4 && rdata.itemNum == 24){\n          changeMakeNodes({imgNum: 5, id: params[q].id, type: \"remove\"})\n        }else if(rdata.partNum == 4 && rdata.itemNum == 25){\n          changeMakeNodes({imgNum: 6, id: params[q].id, type: \"remove\"})\n        }else if(rdata.partNum == 0 && rdata.itemNum == 22){\n          changeMakeNodes({imgNum: 7, id: params[q].id, type: \"remove\"})\n        }else{\n          return\n        }\n      }\n    }else if(params[q].type == \"select\"){\n      var snode\n      if(params[q].id.indexOf('make') > -1 || params[q].id.indexOf('branch') > -1){\n        //メイクノードかブランチノードだったら\n        snode = getNode.value(params[q].id)\n        if(params[q].selected){\n          snode.style['--vf-node-color'] = '#3cb371'\n        }else{\n          snode.style['--vf-node-color'] = 'black'\n        }\n      }\n      if(store.state.turn == 2){\n        if(params[q].id.indexOf('make') > -1){\n          //メイクノードだったら\n          if(params[q].selected){\n            if(!snode.data[\"skip\"]){\n              //skipがfalseだったら\n              snode.style['--vf-node-text'] = '#ff8c00'\n              snode.data[\"skip\"] = true\n            }else{\n              //skipがtrueだったら\n              snode.style['--vf-node-text'] = 'black'\n              snode.data[\"skip\"] = false\n            }\n          }\n        }\n      }else if(store.state.turn == 3){\n        if(params[q].id.indexOf('make') > -1){\n          //メイクノードだったら\n          if(params[q].selected){\n            if(!snode.data[\"forget\"]){\n              //forgetがfalseだったら\n              snode.style[\"--vf-node-bg\"] = \"pink\"\n              snode.data[\"forget\"] = true\n            }else{\n              //forgetがtrueだったら\n              snode.style[\"--vf-node-bg\"] = \"white\"\n              snode.data[\"forget\"] = false\n            }\n          }\n        }\n      }\n    }\n    else{\n      return\n    }\n  }\n})\n/* エッジの変更時に発火する関数 */\nonEdgesChange((params) => {\n  var NumOfSameSources\n  //params add:[type, item{}]  remove:[type, id]  select:[type, id, selected]\n  for(var i=0; i<params.length; i++){\n    if(params[i].type == \"add\"){\n      var edgeItem = params[i].item\n      //edgeSNumに新しいエッジを追加する\n      Skeys = Object.keys(edgeSNum) //最新版に更新\n      if(Skeys.includes(edgeItem.source)){\n        edgeSNum[edgeItem.source].push(edgeItem.id)\n      }else{\n        edgeSNum[edgeItem.source] = []\n        edgeSNum[edgeItem.source].push(edgeItem.id)\n        Skeys = Object.keys(edgeSNum)\n      }\n      //追加するエッジと同じsourceのエッジが何本あるか調べる\n      NumOfSameSources = surveySameSource(edgeItem.source)\n      //エッジが現状で1本以上あったらエッジをsmoothstepに切り替える\n      if(NumOfSameSources >= 1){\n        elements.value.forEach((el) => {\n          if (isEdge(el) && el.source == edgeItem.source) {\n            el.type = \"smoothstep\"\n          }\n        })\n      }\n    }else if(params[i].type == \"remove\"){\n      var source\n      var edgeData\n      //消すエッジと同じsourceのエッジが何本あるか調べる\n      elements.value.forEach((el) => {\n        if (el.id == params[i].id) {\n          edgeData = el\n          source = el.source\n          NumOfSameSources = surveySameSource(source)\n        }\n      })\n      //エッジが現状で2本以下だったらエッジをstraightに切り替える\n      if(NumOfSameSources == 2){\n        elements.value.forEach((el) => {\n          if (isEdge(el) && el.source == source) {\n            el.type = \"straight\"\n          }\n        })\n      }\n      //edgeListの状態変更\n      changeEdges(edgeData, \"remove\")\n    }else if(params[i].type == \"select\"){\n      var sedge = getEdge.value(params[i].id)\n      if(params[i].selected){\n        sedge.animated = true\n        //turn2だったらラベル設定用にidを保存する\n        if(store.state.turn == 2){\n          store.commit(\"setEdgeId\", params[i].id)\n        }\n      }else{\n        sedge.animated = false\n        //turn2だったらラベル設定用にidを保存する\n        if(store.state.turn == 2){\n          store.commit(\"setEdgeId\", \"\")\n        }\n      }\n    }else{\n      return\n    }\n  }\n})\n/* エッジの追加時に発火する関数 onConnect->onEdgesChange */\nonConnect((params) => {\n  console.log(\"エッジの追加\")\n  //params:[source, sourceHandle, target, targetHandle]\n\n  //同じソースのエッジの本数を取得する\n  var NumOfEdge\n  Skeys = Object.keys(edgeSNum)\n  if(Skeys.includes(params.source)){\n    NumOfEdge = surveySameSource(params.source) +1\n  }else{\n    NumOfEdge = 1\n  }\n\n  //新しいエッジの追加\n  var newEdge\n  const getEdgeId = () => `e${params.source}_${params.target}`\n  if(NumOfEdge < 3){\n    if(params.source.indexOf('make') > -1){\n      //customMakeだったら\n      if(NumOfEdge < 2){\n        newEdge = {\n          id: getEdgeId(),\n          source: params.source,\n          target: params.target,\n          type: 'straight',\n          style: { stroke: 'black' },\n          markerEnd: MarkerType.ArrowClosed,\n          animated: false,\n        }\n      }else{\n        //メイクノードではエッジを1本しか生やせない\n        alert(\"1つの化粧ノードから出せる矢印は1本だけです.追加で分岐させたい場合は分岐ノードを繋げてください\")\n        return\n      }\n    }else if(params.source.indexOf('branch') > -1){\n      //customBranchだったら\n      var addEdgeLabel\n      var addEdgeColor\n      var addEdgeType\n      if(params.source.indexOf('mvbranch') > -1){\n        //やる気ノード\n        addEdgeLabel = NumOfEdge%2 == 0 ? \"なし\" : \"あり\"\n        addEdgeColor = NumOfEdge%2 == 0 ? 'blue' : 'red'\n        addEdgeType = NumOfEdge%2 == 0 ? 'no' : 'max'\n      }else if(params.source.indexOf('sbranch') > -1){\n        //季節ノード\n        addEdgeLabel = NumOfEdge%2 == 0 ? \"冬\" : \"夏\"\n        addEdgeColor = NumOfEdge%2 == 0 ? 'gray' : 'blue'\n        addEdgeType = NumOfEdge%2 == 0 ? 'winter' : 'summer'\n      }else{\n        //時間ノード\n        addEdgeLabel = NumOfEdge%2 == 0 ? \"短い\" : \"長い\"\n        addEdgeColor = NumOfEdge%2 == 0 ? 'blue' : 'red'\n        addEdgeType = NumOfEdge%2 == 0 ? 'short' : 'long'\n      }\n      newEdge = {\n        id: getEdgeId(),\n        source: params.source,\n        target: params.target,\n        type: NumOfEdge>1 ? 'smoothstep' : 'straight',\n        label: addEdgeLabel,\n        style: { stroke: addEdgeColor },\n        labelStyle: { fill: 'white' },\n        labelBgStyle: { fill: addEdgeColor },\n        markerEnd: MarkerType.ArrowClosed,\n        animated: false,\n        data: {\n          type: addEdgeType\n        },\n      }\n    }else{\n      //input/outputだったら\n      if(NumOfEdge < 2){\n        newEdge = {\n          id: getEdgeId(),\n          source: params.source,\n          target: params.target,\n          type: 'straight',\n          style: { stroke: 'black' },\n          markerEnd: MarkerType.ArrowClosed,\n          animated: false,\n        }\n      }else{\n        //メイクノードではエッジを1本しか生やせない\n        alert(\"1つのメイク開始/終了ノードから出せる矢印は1本だけです.追加で分岐させたい場合は分岐ノードを繋げてください\")\n        return\n      }\n    }\n  }else{\n    //新しく足すエッジが3本目だったら追加させない\n    alert(\"1つのノードから出せる矢印は2本までです.追加で分岐させたい場合は分岐ノードを繋げてください\")\n    return\n  }\n  addEdges([newEdge])\n})\n\n/* マウス操作に結びつけた関数 */\n//ノードのドラッグ操作\nconst onDragOver = (event) => {\n  event.preventDefault()\n  if (event.dataTransfer) {\n    event.dataTransfer.dropEffect = 'move'\n  }\n}\n//ノードのドロップによる，新規ノードの追加\nlet id = 0\nconst ss_getId = () => `ss_${id++}`\nconst m_getId = () => `make_${id++}`\nconst mv_getId = () => `mvbranch_${id++}`\nconst s_getId = () => `sbranch_${id++}`\nconst t_getId = () => `tbranch_${id++}`\nconst onDrop = (event) => {\n  const type = event.dataTransfer?.getData('application/vueflow')\n  const position = project({ x: event.clientX - 400, y: event.clientY - 150 })\n  var newNode\n  if(type == 'input' || type == 'output'){\n    //開始ノードか終了ノード\n    newNode = {\n      id: ss_getId(), type, position,\n      label: type == 'input' ? `メイク開始` : `メイク終了`,\n    }\n  }else if(type == 'customMake'){\n    //メイクノード\n    newNode = {\n      id: m_getId(),\n      type, position,\n      label: store.state.itemName.length >= 7\n        ? store.state.itemName+\"\\n(\"+store.state.typeName+\")\"\n        : store.state.itemName+\"(\"+store.state.typeName+\")\",\n      style: { '--vf-node-color': 'black' },\n      data: {\n        partName: store.state.partName,\n        partNum: store.state.partNum,\n        itemName: store.state.itemName,\n        itemNum: store.state.itemNum,\n        typeName: store.state.typeName,\n        typeNum: store.state.typeNum,\n        skip: false,\n        forget: false,\n      }\n    }\n  }else{\n    //分岐ノード\n    var nodeLabel\n    var nodeId\n    if(type == 'customMotivation'){\n      nodeLabel = \"気合い\"\n      nodeId = mv_getId()\n    }else if(type == 'customSeason'){\n      nodeLabel = \"季節\"\n      nodeId = s_getId()\n    }else{\n      nodeLabel = \"外出時間\"\n      nodeId = t_getId()\n    }\n    newNode = {\n      id: nodeId,\n      type, position,\n      label: nodeLabel,\n      style: { '--vf-node-color': 'black' },\n    }\n  }\n  addNodes([newNode])\n}\n\n/* vueFlow上のボタン操作 */\n//現在のviewpaneの変換 (ズームとパン) をリセット\nconst resetTrans = () => {\n  setTransform({ x: 0, y: 0, zoom: 1 })\n}\n//toObjectは、現在のグラフデータを簡単に永続化できるオブジェクトに変換\nconst logToObject = () => {\n  console.log(\"データのmysqlへの送信\")\n  const params = new URLSearchParams()\n  params.append('userId', store.state.userId)\n  params.append('userName', store.state.userName)\n  params.append('flowchart', JSON.stringify(toObject()))\n  axios.post('https://takano.nkmr.io/flowchart_post.php', params)\n  .then((response)=>{\n    //上手く行った時\n    console.log('status:',response.status)\n  }).catch((error)=>{\n    //失敗した時\n    console.log('err:',error)\n  })\n  //フローチャートデータのダウンロード\n  /*\n  const fileName = store.state.userName+\".json\"\n  const flowData = JSON.stringify(toObject())\n  const link = document.createElement(\"a\")\n  link.href = \"data:text/plain,\" + encodeURIComponent(flowData)\n  link.download = fileName\n  link.click()\n  */\n  //フローチャート画像のダウンロード\n  var svg = document.querySelector('.basicflow')\n  var svgData = new XMLSerializer().serializeToString(svg)\n  var canvas = document.createElement(\"canvas\")\n  canvas.width = \"800px\" //svg.width.baseVal.value\n  canvas.height = \"760px\" //svg.height.baseVal.value\n\n  var ctx = canvas.getContext(\"2d\")\n  var image = new Image\n  image.onload = function(){\n    ctx.drawImage( image, 0, 0 )\n    var a = document.createElement(\"a\")\n    a.href = canvas.toDataURL(\"image/png\")\n    a.setAttribute(\"download\", store.state.userName+\".png\")\n    a.dispatchEvent(new MouseEvent(\"click\"))\n  }\n  image.src = \"data:image/svg+xml;charset=utf-8;base64,\" + btoa(unescape(encodeURIComponent(svgData)))\n}\n\nconst submitFlowchart = () => {\n  console.log(\"データのmysqlへの送信&実験終了\")\n  const params2 = new URLSearchParams()\n  params2.append('userId', store.state.userId)\n  params2.append('userName', store.state.userName)\n  params2.append('flowchart', JSON.stringify(toObject()))\n  axios.post('https://takano.nkmr.io/flowchart_post.php', params2)\n  .then((response)=>{\n    //上手く行った時\n    console.log('status:',response.status)\n  }).catch((error)=>{\n    //失敗した時\n    console.log('err:',error)\n  })\n  //フローチャートデータのダウンロード\n  const fileName2 = store.state.userName+\".json\"\n  const flowData2 = JSON.stringify(toObject())\n  const link2 = document.createElement(\"a\")\n  link2.href = \"data:text/plain,\" + encodeURIComponent(flowData2)\n  link2.download = fileName2\n  link2.click()\n  //実験終了画面へ移動\n  setTimeout(function(){\n    router.push('/finish')\n  }, 3000)\n}\n</script>\n\n<template>\n  <TopMenu @submitObject=\"submitFlowchart\" /> <!-- @checkTurn1=\"checkOutput\" -->\n  <div class=\"dndflow\" @drop=\"onDrop\">\n    <div class=\"sidemenu\">\n      <FaceImage />\n      <NodeSettings />\n      <NodeField />\n    </div>\n    <VueFlow\n      class=\"basicflow\" v-model=\"elements\"\n      :node-types=\"nodeTypes\" :default-zoom=\"1.5\" :min-zoom=\"0.2\" :max-zoom=\"4\"\n      :fit-view-on-init=\"true\" :snap-to-grid=\"true\" :connection-mode=\"ConnectionMode.Loose\"\n      @dragover=\"onDragOver\" @pane-ready=\"onLoad\" @selection-context-menu=\"selectMenu\"\n      @contextmenu.prevent.stop=\"handleClick($event)\"\n    >\n      <Background pattern-color=\"#000000\" gap=\"8\" />\n      <MiniMap />\n      <Controls />\n      <div class=\"controls\">\n        <button style=\"background-color: #191970; color: white;\" @click=\"resetTrans\">reset transform</button>\n        <button @click=\"logToObject\">log toObject</button>\n      </div>\n      <!--カスタムノードの設定-->\n      <template #node-Make=\"props\">\n        <MakeNode v-bind=\"props\" />\n      </template>\n      <template #node-Motivation=\"props\">\n        <MotivationNode v-bind=\"props\" />\n      </template>\n      <template #node-Season=\"props\">\n        <SeasonNode v-bind=\"props\" />\n      </template>\n      <template #node-Time=\"props\">\n        <TimeNode v-bind=\"props\" />\n      </template>\n      <!--context-menuの設定-->\n      <vue-simple-context-menu\n        element-id=\"myUniqueId\"\n        :options=\"options\"\n        ref=\"vueContextMenu\"\n        @option-clicked=\"optionClicked\"\n      />\n    </VueFlow>\n  </div>\n</template>\n\n<style>\n@import '../css/flowchart.css';\n</style>"]}]}